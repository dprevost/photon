# Copyright (C) 2006 Daniel Prevost <dprevost@users.sourceforge.net>
#  
# This file is free software; as a special exception the author gives
# unlimited permission to copy and/or distribute it, with or without 
# modifications, as long as this notice is preserved.
# 
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY, to the extent permitted by law; without even the
# implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

CLEANFILES = *~ core

check_PROGRAMS =                     \
                 bget                \
                 bgetNULLAlloc       \
                 bgetNULLInfo        \
                 bgetPass            \
                 bgetZeroLen         \
                 bpoolNULLAlloc      \
                 bpoolNULLBuf        \
                 bpoolNULLInfo       \
                 bpoolPass           \
                 bpoolZeroLen        \
                 brelNULLAlloc       \
                 brelNULLInfo        \
                 brelNULLPtr         \
                 brelPass            \
                 CloseNULLAlloc      \
                 CloseNULLInfo       \
                 ClosePass           \
                 FreeBuffNULLAlloc   \
                 FreeBuffNULLArray   \
                 FreeBuffNULLInfo    \
                 FreeBuffPass        \
                 FreeBuffZeroLen     \
                 FreeNULLAlloc       \
                 FreeNULLInfo        \
                 FreeNULLPtr         \
                 FreePass            \
                 GetBuffNULLAlloc    \
                 GetBuffNULLArray    \
                 GetBuffNULLInfo     \
                 GetBuffPass         \
                 GetBuffZeroLen      \
                 InitNULLAddr        \
                 InitNULLAlloc       \
                 InitNULLBase        \
                 InitNULLInfo        \
                 InitPass            \
                 InitZeroLen         \
                 IsBuffNULLAlloc     \
                 IsBuffNULLBuf       \
                 IsBuffNULLInfo      \
                 IsBuffPass          \
                 Macros              \
                 MallocNULLAlloc     \
                 MallocNULLInfo      \
                 MallocPass          \
                 MallocZeroLen       \
                 RecoverNULLAlloc    \
                 RecoverNULLInfo     \
                 RecoverNULLNum      \
                 RecoverPass         \
                 ResetStatsNULLAlloc \
                 ResetStatsNULLInfo  \
                 ResetStatsPass      \
                 SetBaseNULLAlloc    \
                 SetBaseNULLBase     \
                 SetBaseNULLInfo     \
                 SetBasePass         \
                 StatsNULLAlloc      \
                 StatsNULLCurrent    \
                 StatsNULLInfo       \
                 StatsNULLMax        \
                 StatsNULLNumFree    \
                 StatsNULLNumMalloc  \
                 StatsNULLTotal      \
                 StatsPass           \
                 ValidateNULLAlloc   \
                 ValidateNULLInfo    \
                 ValidatePass

bget_SOURCES                = bget.cpp
bgetNULLAlloc_SOURCES       = bgetNULLAlloc.c
bgetNULLInfo_SOURCES        = bgetNULLInfo.c
bgetPass_SOURCES            = bgetPass.c
bgetZeroLen_SOURCES         = bgetZeroLen.c
bpoolNULLAlloc_SOURCES      = bpoolNULLAlloc.c
bpoolNULLBuf_SOURCES        = bpoolNULLBuf.c
bpoolNULLInfo_SOURCES       = bpoolNULLInfo.c
bpoolPass_SOURCES           = bpoolPass.c
bpoolZeroLen_SOURCES        = bpoolZeroLen.c
brelNULLAlloc_SOURCES       = brelNULLAlloc.c
brelNULLInfo_SOURCES        = brelNULLInfo.c
brelNULLPtr_SOURCES         = brelNULLPtr.c
brelPass_SOURCES            = brelPass.c
CloseNULLAlloc_SOURCES      = CloseNULLAlloc.c
CloseNULLInfo_SOURCES       = CloseNULLInfo.c
ClosePass_SOURCES           = ClosePass.c
FreeBuffNULLAlloc_SOURCES   = FreeBuffNULLAlloc.c
FreeBuffNULLArray_SOURCES   = FreeBuffNULLArray.c
FreeBuffNULLInfo_SOURCES    = FreeBuffNULLInfo.c
FreeBuffPass_SOURCES        = FreeBuffPass.c
FreeBuffZeroLen_SOURCES     = FreeBuffZeroLen.c
FreeNULLAlloc_SOURCES       = FreeNULLAlloc.c
FreeNULLInfo_SOURCES        = FreeNULLInfo.c
FreeNULLPtr_SOURCES         = FreeNULLPtr.c
FreePass_SOURCES            = FreePass.c
GetBuffNULLAlloc_SOURCES    = GetBuffNULLAlloc.c
GetBuffNULLArray_SOURCES    = GetBuffNULLArray.c
GetBuffNULLInfo_SOURCES     = GetBuffNULLInfo.c
GetBuffPass_SOURCES         = GetBuffPass.c
GetBuffZeroLen_SOURCES      = GetBuffZeroLen.c
InitNULLAddr_SOURCES        = InitNULLAddr.c
InitNULLAlloc_SOURCES       = InitNULLAlloc.c
InitNULLBase_SOURCES        = InitNULLBase.c
InitNULLInfo_SOURCES        = InitNULLInfo.c
InitPass_SOURCES            = InitPass.c
InitZeroLen_SOURCES         = InitZeroLen.c
IsBuffNULLAlloc_SOURCES     = IsBuffNULLAlloc.c
IsBuffNULLBuf_SOURCES       = IsBuffNULLBuf.c
IsBuffNULLInfo_SOURCES      = IsBuffNULLInfo.c
IsBuffPass_SOURCES          = IsBuffPass.c
Macros_SOURCES              = Macros.c
MallocNULLAlloc_SOURCES     = MallocNULLAlloc.c
MallocNULLInfo_SOURCES      = MallocNULLInfo.c
MallocPass_SOURCES          = MallocPass.c
MallocZeroLen_SOURCES       = MallocZeroLen.c
RecoverNULLAlloc_SOURCES    = RecoverNULLAlloc.c
RecoverNULLInfo_SOURCES     = RecoverNULLInfo.c
RecoverNULLNum_SOURCES      = RecoverNULLNum.c
RecoverPass_SOURCES         = RecoverPass.c
ResetStatsNULLAlloc_SOURCES = ResetStatsNULLAlloc.c
ResetStatsNULLInfo_SOURCES  = ResetStatsNULLInfo.c
ResetStatsPass_SOURCES      = ResetStatsPass.c
SetBaseNULLAlloc_SOURCES    = SetBaseNULLAlloc.c
SetBaseNULLBase_SOURCES     = SetBaseNULLBase.c
SetBaseNULLInfo_SOURCES     = SetBaseNULLInfo.c
SetBasePass_SOURCES         = SetBasePass.c
StatsNULLAlloc_SOURCES      = StatsNULLAlloc.c
StatsNULLCurrent_SOURCES    = StatsNULLCurrent.c
StatsNULLInfo_SOURCES       = StatsNULLInfo.c
StatsNULLMax_SOURCES        = StatsNULLMax.c
StatsNULLNumFree_SOURCES    = StatsNULLNumFree.c
StatsNULLNumMalloc_SOURCES  = StatsNULLNumMalloc.c
StatsNULLTotal_SOURCES      = StatsNULLTotal.c
StatsPass_SOURCES           = StatsPass.c
ValidateNULLAlloc_SOURCES   = ValidateNULLAlloc.c
ValidateNULLInfo_SOURCES    = ValidateNULLInfo.c
ValidatePass_SOURCES        = ValidatePass.c

EXTRA_DIST =         \
             bget.sh

TESTS_ENVIRONMENT = srcdir=$(srcdir) top_builddir=$(top_builddir) verbose=1 PYTHON=$(PYTHON)

TESTS1 = Macros

TESTS =                     \
        bgetNULLAlloc       \
        bgetNULLInfo        \
        bgetZeroLen         \
        bgetPass            \
        bpoolNULLAlloc      \
        bpoolNULLBuf        \
        bpoolNULLInfo       \
        bpoolZeroLen        \
        bpoolPass           \
        brelNULLAlloc       \
        brelNULLInfo        \
        brelNULLPtr         \
        brelPass            \
        CloseNULLAlloc      \
        CloseNULLInfo       \
        ClosePass           \
        FreeBuffNULLAlloc   \
        FreeBuffNULLArray   \
        FreeBuffNULLInfo    \
        FreeBuffZeroLen     \
        FreeBuffPass        \
        FreeNULLAlloc       \
        FreeNULLInfo        \
        FreeNULLPtr         \
        FreePass            \
        GetBuffNULLAlloc    \
        GetBuffNULLArray    \
        GetBuffNULLInfo     \
        GetBuffZeroLen      \
        GetBuffPass         \
        InitNULLAddr        \
        InitNULLAlloc       \
        InitNULLBase        \
        InitNULLInfo        \
        InitPass            \
        InitZeroLen         \
        IsBuffNULLAlloc     \
        IsBuffNULLBuf       \
        IsBuffNULLInfo      \
        IsBuffPass          \
        Macros              \
        MallocNULLAlloc     \
        MallocNULLInfo      \
        MallocPass          \
        MallocZeroLen       \
        RecoverNULLAlloc    \
        RecoverNULLInfo     \
        RecoverNULLNum      \
        RecoverPass         \
        ResetStatsNULLAlloc \
        ResetStatsNULLInfo  \
        ResetStatsPass      \
        SetBaseNULLAlloc    \
        SetBaseNULLBase     \
        SetBaseNULLInfo     \
        SetBasePass         \
        StatsNULLAlloc      \
        StatsNULLCurrent    \
        StatsNULLInfo       \
        StatsNULLMax        \
        StatsNULLNumFree    \
        StatsNULLNumMalloc  \
        StatsNULLTotal      \
        StatsPass           \
        ValidateNULLAlloc   \
        ValidateNULLInfo    \
        ValidatePass        \
        bget.sh            

XFAIL_TESTS =                     \
              bgetNULLAlloc       \
              bgetNULLInfo        \
              bgetZeroLen         \
              bpoolNULLAlloc      \
              bpoolNULLBuf        \
              bpoolNULLInfo       \
              bpoolZeroLen        \
              brelNULLAlloc       \
              brelNULLInfo        \
              brelNULLPtr         \
              CloseNULLAlloc      \
              CloseNULLInfo       \
              FreeBuffNULLAlloc   \
              FreeBuffNULLArray   \
              FreeBuffNULLInfo    \
              FreeBuffZeroLen     \
              FreeNULLAlloc       \
              FreeNULLInfo        \
              FreeNULLPtr         \
              GetBuffNULLAlloc    \
              GetBuffNULLArray    \
              GetBuffNULLInfo     \
              GetBuffZeroLen      \
              InitNULLAddr        \
              InitNULLAlloc       \
              InitNULLBase        \
              InitNULLInfo        \
              InitZeroLen         \
              IsBuffNULLAlloc     \
              IsBuffNULLBuf       \
              IsBuffNULLInfo      \
              MallocNULLAlloc     \
              MallocNULLInfo      \
              MallocZeroLen       \
              RecoverNULLAlloc    \
              RecoverNULLInfo     \
              RecoverNULLNum      \
              ResetStatsNULLAlloc \
              ResetStatsNULLInfo  \
              SetBaseNULLAlloc    \
              SetBaseNULLBase     \
              SetBaseNULLInfo     \
              StatsNULLAlloc      \
              StatsNULLCurrent    \
              StatsNULLInfo       \
              StatsNULLMax        \
              StatsNULLNumFree    \
              StatsNULLNumMalloc  \
              StatsNULLTotal      \
              ValidateNULLAlloc   \
              ValidateNULLInfo

LDADD = $(top_builddir)/src/Engine/libEngine.la \
        $(top_builddir)/src/Common/libCommon.la

AM_CPPFLAGS = -I$(top_srcdir)/src/Engine \
              -I$(top_srcdir)/src/Common \
              -I$(top_srcdir)/src/include

if COND_USE_ASSERT
   AM_CPPFLAGS += -DUSE_ASSERT
endif
if COND_USE_TRAP_ERRORS
   AM_CPPFLAGS += -DUSE_TRAP_ERRORS
endif

if COND_USE_DBC
   AM_CPPFLAGS += -DUSE_DBC
endif
if COND_USE_EXTREME_DBC
   AM_CPPFLAGS += -DUSE_EXTREME_DBC
endif

distclean-local:
	-rm -rf $(testsubdir)

